<div class="container">
  <h3>Create New Event</h3>
  <form (submit)="addEvent()" #eventForm="ngForm">
    <!-- Name -->
    <div class="form-group">
      <label for="eventName">Event Name</label>
      <input
        type="text"
        class="form-control"
        id="eventName"
        [(ngModel)]="newEvent.name"
        name="name"
        required
      />
    </div>

    <!-- Date -->
    <div class="form-group">
      <label for="eventDate">Date</label>
      <input
        type="date"
        class="form-control"
        id="eventDate"
        [(ngModel)]="newEvent.date"
        name="date"
        required
      />
    </div>

    <!-- Venue Name -->
    <div class="form-group">
      <label for="venueName">Venue Name</label>
      <input
        type="text"
        class="form-control"
        id="venueName"
        [(ngModel)]="newEvent.venueName"
        name="venueName"
        required
      />
    </div>

    <!-- Minimum Age -->
    <div class="form-group">
      <label for="minimumAge">Minimum Age</label>
      <input
        type="number"
        class="form-control"
        id="minimumAge"
        [(ngModel)]="newEvent.minimumAge"
        name="minimumAge"
        required
      />
    </div>

    <!-- Description -->
    <div class="form-group">
      <label for="description">Description</label>
      <textarea
        class="form-control"
        id="description"
        [(ngModel)]="newEvent.description"
        name="description"
        required
      ></textarea>
    </div>

    <!-- Ticket List (Multiple Ticket Types) -->
    <h5>Tickets</h5>
    <div
      *ngFor="let ticket of newEvent.tickets; let i = index"
      class="form-group"
    >
      <label>Ticket Type {{ i + 1 }}</label>
      <input
        type="text"
        class="form-control"
        placeholder="Ticket Type"
        [(ngModel)]="ticket.ticketType"
        [name]="'ticketName' + i"
        required
      />
      <input
        type="number"
        class="form-control mt-2"
        placeholder="Ticket Price"
        [(ngModel)]="ticket.price"
        [name]="'ticketPrice' + i"
        required
      />
      <button
        type="button"
        class="btn btn-danger mt-2"
        (click)="removeTicket(ticket.ticketType)"
      >
        Remove Ticket
      </button>
    </div>
    <button
      type="button"
      class="btn btn-secondary mt-2"
      (click)="addTicketType()"
    >
      Add Another Ticket Type
    </button>

    <!-- Profile Image Upload -->
    <div class="form-group mt-4">
      <label for="profileImage">Profile Image</label>
      <input
        type="file"
        class="form-control-file"
        id="profileImage"
        (change)="onProfileImageSelected($event)"
      />
      <img
        *ngIf="profileImagePreview"
        [src]="profileImagePreview"
        class="img-thumbnail mt-2"
        width="200"
      />
    </div>

    <!-- Images Paths (Multiple Image Upload) -->
    <div class="form-group mt-4">
      <label for="imagesPaths">Event Images</label>
      <input
        type="file"
        class="form-control-file"
        id="imagesPaths"
        (change)="onImagesSelected($event)"
        multiple
      />
      <div *ngIf="imagesPreviews.length > 0" class="mt-3">
        <h6>Image Previews:</h6>
        <div *ngFor="let img of imagesPreviews" class="d-inline-block">
          <img [src]="img" class="img-thumbnail m-1" width="100" />
        </div>
      </div>
    </div>

    <button
      type="submit"
      class="btn btn-primary mt-4"
      [disabled]="!eventForm.valid"
    >
      {{ editFlag ? "Edit Event" : "Add Event" }}
    </button>
  </form>

  <!-- List of available tickets -->
  <h3 class="mt-5">Available Tickets</h3>
  <ul *ngIf="eventsList.length > 0; else noEvents" class="list-group">
    <li
      *ngFor="let event of eventsList"
      class="list-group-item d-flex justify-content-between align-items-center"
    >
      {{ event.name }}
      <button class="btn btn-danger" (click)="removeEvent(event.name)">
        Remove
      </button>

      <!-- Edit button with image -->
      <button class="btn btn-secondary" (click)="showEditEvent(event)">
        <img src="../../../assets/edit.png" alt="Edit" width="20" height="20" />
      </button>
    </li>
  </ul>

  <ng-template #noEvents>
    <p>No events available. Add some events to the store.</p>
  </ng-template>
</div>
